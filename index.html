<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø·Ù…Ø£Ù†ÙŠÙ†Ø©</title>
    
    <link rel="apple-touch-icon" href="https://i.ibb.co/Fbndx8dy/image.png">
    <link rel="icon" type="image/png" href="https://i.ibb.co/Fbndx8dy/image.png">
    <meta property="og:image" content="https://i.ibb.co/Fbndx8dy/image.png">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&display=swap');
        
        :root {
            --morn-grad: linear-gradient(135deg, #f1c40f, #f39c12);
            --even-grad: linear-gradient(135deg, #e67e22, #d35400);
            --sleep-grad: linear-gradient(135deg, #2980b9, #2c3e50);
            --count-grad: linear-gradient(135deg, #27ae60, #16a085);
            --stats-grad: linear-gradient(135deg, #ff8c00, #ff4500);
            --font-size: 1.1rem;
        }

        body { 
            font-family: 'Tajawal', sans-serif; margin: 0; background: #fdfdfd; 
            color: #333; overflow-x: hidden; -webkit-tap-highlight-color: transparent;
        }

        /* Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù‡ÙŠØ¯Ø± Ù„Ù…Ù†Ø¹ ØªØ¯Ø§Ø®Ù„ Ø§Ù„ØªØ±ÙˆØ³ */
        .header { 
            padding: 15px; display: flex; justify-content: flex-end; 
            position: relative; width: 100%; box-sizing: border-box; z-index: 10; 
        }

        .icon-btn { 
            background: rgba(0,0,0,0.05); border: none; width: 40px; height: 40px; 
            border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; 
        }

        .home-screen { 
            display: flex; flex-direction: column; align-items: center; 
            padding: 10px 20px 40px; text-align: center;
        }

        .main-logo { 
            font-size: 3rem; font-weight: 900; color: #003a70; margin: 10px 0 5px; 
        }

        .quote { color: #888; font-size: 1rem; margin-bottom: 25px; }

        .prayer-card { 
            background: #003a70; color: white; width: 100%; max-width: 350px; 
            border-radius: 20px; padding: 15px; display: flex; justify-content: space-around; 
            margin-bottom: 25px; font-size: 0.8rem; box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }
        .prayer-card b { display: block; font-size: 0.95rem; margin-top: 4px; }

        .buttons-grid { 
            display: grid; grid-template-columns: 1fr 1fr; gap: 15px; 
            width: 100%; max-width: 350px; 
        }

        .grid-btn { 
            aspect-ratio: 1/1; border-radius: 25px; display: flex; flex-direction: column; 
            align-items: center; justify-content: center; color: white; font-weight: bold; 
            cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.08); transition: 0.2s;
        }
        .grid-btn:active { transform: scale(0.96); }
        .grid-btn i { 
            font-size: 2rem; margin-bottom: 10px; background: white; 
            width: 55px; height: 55px; border-radius: 50%; display: flex; 
            align-items: center; justify-content: center; 
        }

        .morn { background: var(--morn-grad); } .morn i { color: #f39c12; }
        .even { background: var(--even-grad); } .even i { color: #d35400; }
        .sleep { background: var(--sleep-grad); } .sleep i { color: #2980b9; }
        .count { background: var(--count-grad); } .count i { color: #27ae60; }
        .stats { 
            background: var(--stats-grad); grid-column: span 2; 
            aspect-ratio: auto; padding: 20px; 
        } 
        .stats i { color: #ff4500; }

        /* Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© */
        .page { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            display: none; flex-direction: column; z-index: 1000; 
        }
        .page.active { display: flex; }
        .page-top { background: white; padding: 15px; text-align: center; border-bottom: 1px solid #eee; }
        .page-content { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }

        .white-card-container { 
            display: flex; align-items: center; width: 100%; 
            max-width: 400px; justify-content: space-between; gap: 10px;
        }
        .white-card { 
            background: white; flex: 1; min-height: 200px; border-radius: 25px; 
            display: flex; align-items: center; justify-content: center; 
            text-align: center; padding: 20px; font-weight: bold; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.15); font-size: var(--font-size); 
        }

        .nav-arrow { 
            background: rgba(255,255,255,0.2); border: none; width: 45px; 
            height: 45px; border-radius: 50%; color: white; font-size: 1.2rem; cursor: pointer;
        }

        .counter-circle { 
            width: 130px; height: 130px; border-radius: 50%; border: 6px solid white; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            color: white; margin-top: 30px; cursor: pointer; 
        }
        .count-val { font-size: 2.5rem; font-weight: bold; }

        .fade { animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        #editOverlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.8); z-index: 2000; display: none; 
            justify-content: center; align-items: center; 
        }
        .edit-box { background: white; width: 85%; border-radius: 20px; padding: 20px; }
    </style>
</head>
<body>

    <div class="header">
        <button class="icon-btn" onclick="openPage('settingsPage')">âš™ï¸</button>
    </div>

    <div class="home-screen fade" id="home">
        <div class="main-logo">Ø·Ù…Ø£Ù†ÙŠÙ†Ø©</div>
        <p class="quote">Ø£Ù„Ø§ Ø¨Ø°ÙƒØ± Ø§Ù„Ù„Ù‡ ØªØ·Ù…Ø¦Ù† Ø§Ù„Ù‚Ù„ÙˆØ¨</p>
        
        <div class="prayer-card">
            <div>Ø§Ù„ÙØ¬Ø±<br><b id="fajr">--:--</b></div>
            <div>Ø§Ù„Ø¸Ù‡Ø±<br><b id="dhuhr">--:--</b></div>
            <div>Ø§Ù„Ø¹ØµØ±<br><b id="asr">--:--</b></div>
            <div>Ø§Ù„Ù…ØºØ±Ø¨<br><b id="maghrib">--:--</b></div>
            <div>Ø§Ù„Ø¹Ø´Ø§Ø¡<br><b id="isha">--:--</b></div>
        </div>

        <div class="buttons-grid">
            <div class="grid-btn morn" onclick="start('morning')"><i>â˜€ï¸</i> Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­</div>
            <div class="grid-btn even" onclick="start('evening')"><i>ğŸŒ‡</i> Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡</div>
            <div class="grid-btn count" onclick="start('counter')"><i>ğŸ“¿</i> Ø§Ù„Ø¹Ø¯Ø§Ø¯</div>
            <div class="grid-btn sleep" onclick="start('sleep')"><i>ğŸŒ™</i> Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù†ÙˆÙ…</div>
            <div class="grid-btn stats" onclick="openPage('statsPage')"><i>ğŸ“Š</i> Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</div>
        </div>
    </div>

    <div id="dhikrPage" class="page">
        <div class="page-top"><b id="topTitle">Ø£Ø°ÙƒØ§Ø±</b></div>
        <div class="page-content" id="pgContent">
            <div class="white-card-container">
                <button class="nav-arrow" onclick="next(event)">â¡ï¸</button>
                <div class="white-card fade" id="txt">...</div>
                <button class="nav-arrow" onclick="prev(event)">â¬…ï¸</button>
            </div>
            
            <div class="counter-circle" onclick="handleTap()">
                <div class="count-val" id="num">0</div>
                <div style="font-size:0.8rem;">Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</div>
            </div>

            <div style="display:flex; gap:10px; margin-top:20px;">
                <button id="addBtn" class="icon-btn" style="display:none; color:white; border:1px solid white;" onclick="addCustom()">+</button>
                <button id="editBtn" class="icon-btn" style="display:none; color:white; border:1px solid white;" onclick="showEditMenu()">âš™ï¸</button>
                <button onclick="resetProg(event)" style="background:none; border:1px solid white; color:white; padding:5px 15px; border-radius:10px;">Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</button>
                <button onclick="closePages(event)" style="background:none; border:1px solid white; color:white; padding:5px 15px; border-radius:10px;">Ø®Ø±ÙˆØ¬</button>
            </div>
        </div>
    </div>

    <div id="statsPage" class="page" style="background:white;">
        <div class="page-top"><b>Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</b></div>
        <div class="page-content">
            <h1 id="todayCount" style="font-size:4rem; color:orange;">0</h1>
            <p>Ø°ÙƒØ± Ø§Ù„ÙŠÙˆÙ…</p>
            <button onclick="closePages()" style="padding:10px 40px; border-radius:10px;">Ø¹ÙˆØ¯Ø©</button>
        </div>
    </div>

    <script>
        // Ø¯Ø§Ù„Ø© ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙˆÙ‚Øª
        function format12h(t) { let [h,m]=t.split(':'); h=parseInt(h); let ap=h>=12?'Ù…':'Øµ'; h=h%12||12; return h+':'+m+' '+ap; }

        const morningList = [{t:"Ø¢ÙŠØ© Ø§Ù„ÙƒØ±Ø³ÙŠ", c:1}, {t:"Ø§Ù„Ø¥Ø®Ù„Ø§Øµ ÙˆØ§Ù„ÙÙ„Ù‚ ÙˆØ§Ù„Ù†Ø§Ø³", c:3}, {t:"Ø£ØµØ¨Ø­Ù†Ø§ ÙˆØ£ØµØ¨Ø­ Ø§Ù„Ù…Ù„Ùƒ Ù„Ù„Ù‡", c:1}];
        const eveningList = [{t:"Ø¢ÙŠØ© Ø§Ù„ÙƒØ±Ø³ÙŠ", c:1}, {t:"Ø§Ù„Ø¥Ø®Ù„Ø§Øµ ÙˆØ§Ù„ÙÙ„Ù‚ ÙˆØ§Ù„Ù†Ø§Ø³", c:3}, {t:"Ø£Ù…Ø³ÙŠÙ†Ø© ÙˆØ£Ù…Ø³Ù‰ Ø§Ù„Ù…Ù„Ùƒ Ù„Ù„Ù‡", c:1}];
        const sleepList = [{t:"Ø¢ÙŠØ© Ø§Ù„ÙƒØ±Ø³ÙŠ", c:1}, {t:"Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ù„Ùƒ", c:1}, {t:"Ø¨Ø§Ø³Ù…Ùƒ Ø±Ø¨ÙŠ ÙˆØ¶Ø¹Øª Ø¬Ù†Ø¨ÙŠ", c:1}];

        let customCounterList = JSON.parse(localStorage.getItem('customDhikr')) || [{t:"Ø£Ø³ØªØºÙØ± Ø§Ù„Ù„Ù‡", c:0}];
        const data = {
            morning: { title:"Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­", grad:"var(--morn-grad)", list: morningList },
            evening: { title:"Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡", grad:"var(--even-grad)", list: eveningList },
            sleep: { title:"Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù†ÙˆÙ…", grad:"var(--sleep-grad)", list: sleepList },
            counter: { title:"Ø§Ù„Ø¹Ø¯Ø§Ø¯", grad:"var(--count-grad)", list: customCounterList, inf:true }
        };

        let active = '', idx = 0, count = 0;

        function start(type) {
            active = type; idx = 0; count = data[type].list[idx].c;
            document.getElementById('topTitle').innerText = data[type].title;
            document.getElementById('pgContent').style.background = data[type].grad;
            document.getElementById('addBtn').style.display = type === 'counter' ? 'block' : 'none';
            document.getElementById('editBtn').style.display = type === 'counter' ? 'block' : 'none';
            openPage('dhikrPage');
            updateUI();
        }

        function updateUI() {
            document.getElementById('txt').innerText = data[active].list[idx].t;
            document.getElementById('num').innerText = count;
        }

        function handleTap() {
            if(data[active].inf) count++; 
            else if(count > 0) count--;
            
            let s = parseInt(localStorage.getItem('todayStats')) || 0;
            localStorage.setItem('todayStats', s + 1);
            document.getElementById('todayCount').innerText = s + 1;
            updateUI();
        }

        function next() { if(idx < data[active].list.length-1) { idx++; count=data[active].list[idx].c; updateUI(); } }
        function prev() { if(idx > 0) { idx--; count=data[active].list[idx].c; updateUI(); } }
        function openPage(id) { document.getElementById(id).classList.add('active'); }
        function closePages() { document.querySelectorAll('.page').forEach(p => p.classList.remove('active')); }
        function resetProg() { idx=0; count=data[active].list[0].c; updateUI(); }

        // Ø¬Ù„Ø¨ Ø§Ù„Ù…ÙˆØ§Ù‚ÙŠØª
        if(navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(p => {
                fetch(`https://api.aladhan.com/v1/timings?latitude=${p.coords.latitude}&longitude=${p.coords.longitude}&method=4`)
                .then(r=>r.json()).then(res => {
                    const t = res.data.timings;
                    document.getElementById('fajr').innerText = format12h(t.Fajr);
                    document.getElementById('dhuhr').innerText = format12h(t.Dhuhr);
                    document.getElementById('asr').innerText = format12h(t.Asr);
                    document.getElementById('maghrib').innerText = format12h(t.Maghrib);
                    document.getElementById('isha').innerText = format12h(t.Isha);
                });
            });
        }
    </script>
</body>
</html>
