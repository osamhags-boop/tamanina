<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø·Ù…Ø£Ù†ÙŠÙ†Ø©</title>
    
    <link rel="apple-touch-icon" href="https://i.ibb.co/Y7N1yD0/image.png">
    <link rel="icon" type="image/png" href="https://i.ibb.co/Y7N1yD0/image.png">
    <meta property="og:image" content="https://i.ibb.co/Y7N1yD0/image.png">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&display=swap');
        
        :root {
            --morn-grad: linear-gradient(135deg, #f1c40f, #f39c12);
            --even-grad: linear-gradient(135deg, #e67e22, #d35400);
            --sleep-grad: linear-gradient(135deg, #2980b9, #2c3e50);
            --count-grad: linear-gradient(135deg, #27ae60, #16a085);
            --stats-grad: linear-gradient(135deg, #ff8c00, #ff4500);
            --font-size: 1.1rem;
        }

        body {
            font-family: 'Tajawal', sans-serif; margin: 0; background: #fdfdfd; 
            color: #333; transition: 0.3s; font-size: var(--font-size);
            overflow-x: hidden; -webkit-tap-highlight-color: transparent;
        }

        .header { padding: 20px; display: flex; justify-content: flex-end; position: absolute; width: 100%; box-sizing: border-box; z-index: 10; }
        .icon-btn { background: rgba(0,0,0,0.05); border: none; width: 45px; height: 45px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 1.3rem; }

        .home-screen { padding: 20px; text-align: center; display: flex; flex-direction: column; align-items: center; min-height: 100vh; justify-content: center; }
        .main-logo { font-size: 3.5rem; font-weight: 900; background: linear-gradient(to bottom, #003a70, #0056a4); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 5px; }
        .quote { color: #888; font-size: 1.1rem; margin-bottom: 30px; }
        
        .prayer-card {
            background: #003a70; color: white; width: 100%; max-width: 350px;
            border-radius: 25px; padding: 18px; display: flex; justify-content: space-around;
            margin-bottom: 25px; font-size: 0.85rem; box-shadow: 0 10px 20px rgba(0,58,112,0.2);
        }
        .prayer-card b { display: block; font-size: 1rem; margin-top: 5px; }

        .buttons-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 100%; max-width: 350px; }
        .grid-btn {
            aspect-ratio: 1/1; border-radius: 30px; display: flex; flex-direction: column;
            align-items: center; justify-content: center; color: white; font-weight: bold; cursor: pointer;
            box-shadow: 0 6px 12px rgba(0,0,0,0.1); transition: transform 0.2s;
        }
        .grid-btn:active { transform: scale(0.95); }
        .grid-btn i { font-size: 2.2rem; margin-bottom: 12px; background: white; width: 65px; height: 65px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        
        .morn { background: var(--morn-grad); } .morn i { color: #f39c12; }
        .even { background: var(--even-grad); } .even i { color: #d35400; }
        .sleep { background: var(--sleep-grad); } .sleep i { color: #2980b9; }
        .count { background: var(--count-grad); } .count i { color: #27ae60; }
        .stats { background: var(--stats-grad); grid-column: span 2; aspect-ratio: auto; padding: 20px; } .stats i { color: #ff4500; }

        .page { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: none; flex-direction: column; align-items: center; z-index: 1000; }
        .page.active { display: flex; }
        .page-top { width: 100%; background: white; padding: 20px 0; text-align: center; border-bottom: 1px solid #eee; }
        .page-content { flex: 1; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.5s; }
        
        .white-card-container { display: flex; align-items: center; width: 95%; justify-content: space-between; gap: 10px; }
        .white-card {
            background: white; width: 70%; min-height: 220px; border-radius: 30px;
            display: flex; align-items: center; justify-content: center; text-align: center;
            padding: 25px; font-weight: bold; color: #333; box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            font-size: var(--font-size); line-height: 1.6;
        }
        
        .nav-arrow { background: rgba(255,255,255,0.3); border: none; width: 50px; height: 50px; border-radius: 50%; font-size: 1.5rem; color: white; cursor: pointer; }

        .counter-circle { 
            width: 140px; height: 140px; border-radius: 50%; border: 8px solid rgba(255,255,255,0.8); 
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            color: white; margin-top: 35px; cursor: pointer; transition: 0.1s; user-select: none;
        }
        .counter-circle:active { transform: scale(0.9); background: rgba(255,255,255,0.2); }
        .count-val { font-size: 3rem; font-weight: bold; }
        
        .control-btns { display: flex; gap: 12px; margin-top: 25px; flex-wrap: wrap; justify-content: center; }
        .btn-small { background: rgba(255,255,255,0.2); border: 1.5px solid white; color: white; padding: 10px 20px; border-radius: 12px; font-size: 0.9rem; font-weight: bold; cursor: pointer; }

        .fade { animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="header">
        <button class="icon-btn" onclick="openPage('settingsPage')">âš™ï¸</button>
    </div>

    <div class="home-screen fade" id="home">
        <div class="main-logo">Ø·Ù…Ø£Ù†ÙŠÙ†Ø©</div>
        <p class="quote">Ø£Ù„Ø§ Ø¨Ø°ÙƒØ± Ø§Ù„Ù„Ù‡ ØªØ·Ù…Ø¦Ù† Ø§Ù„Ù‚Ù„ÙˆØ¨</p>
        <div class="prayer-card">
            <div>Ø§Ù„ÙØ¬Ø±<br><b id="fajr">--:--</b></div>
            <div>Ø§Ù„Ø¸Ù‡Ø±<br><b id="dhuhr">--:--</b></div>
            <div>Ø§Ù„Ø¹ØµØ±<br><b id="asr">--:--</b></div>
            <div>Ø§Ù„Ù…ØºØ±Ø¨<br><b id="maghrib">--:--</b></div>
            <div>Ø§Ù„Ø¹Ø´Ø§Ø¡<br><b id="isha">--:--</b></div>
        </div>
        <div class="buttons-grid">
            <div class="grid-btn morn" onclick="start('morning')"><i>â˜€ï¸</i> Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­</div>
            <div class="grid-btn even" onclick="start('evening')"><i>ğŸŒ‡</i> Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡</div>
            <div class="grid-btn count" onclick="start('counter')"><i>ğŸ“¿</i> Ø§Ù„Ø¹Ø¯Ø§Ø¯</div>
            <div class="grid-btn sleep" onclick="start('sleep')"><i>ğŸŒ™</i> Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù†ÙˆÙ…</div>
            <div class="grid-btn stats" onclick="openPage('statsPage')"><i>ğŸ“Š</i> Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</div>
        </div>
    </div>

    <div id="dhikrPage" class="page">
        <div class="page-top">
            <i id="topIcon" style="font-size: 1.5rem;">â˜€ï¸</i><br>
            <b id="topTitle">Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­</b>
        </div>
        <div class="page-content" id="pgContent">
            <div class="white-card-container">
                <button class="nav-arrow" onclick="prev(event)">â¬…ï¸</button>
                <div class="white-card fade" id="txt">...</div>
                <button class="nav-arrow" onclick="next(event)">â¡ï¸</button>
            </div>
            <div class="counter-circle" id="tapZone" onclick="handleTap()">
                <div class="count-val" id="num">0</div>
                <div style="font-size:0.8rem; font-weight:bold;" id="countLabel">Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</div>
            </div>
            <div class="control-btns">
                <button id="addBtn" class="btn-small" style="display:none;" onclick="addCustom(event)">+ Ø¥Ø¶Ø§ÙØ© Ø°ÙƒØ±</button>
                <button class="btn-small" onclick="resetProg(event)">Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</button>
                <button class="btn-small" onclick="closePages(event)">Ø®Ø±ÙˆØ¬</button>
            </div>
        </div>
    </div>

    <div id="settingsPage" class="page" style="background:#fff">
        <div class="page-top"><b>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</b></div>
        <div style="padding:20px; display:flex; flex-direction:column; gap:15px; width:85%;">
            <label>Ø­Ø¬Ù… Ø§Ù„Ø®Ø·</label>
            <select onchange="changeFontSize(this.value)" style="padding:12px; border-radius:12px; border:1px solid #ddd; font-family:inherit;">
                <option value="1rem">ØµØºÙŠØ±</option>
                <option value="1.1rem" selected>Ø¹Ø§Ø¯ÙŠ</option>
                <option value="1.3rem">ÙƒØ¨ÙŠØ±</option>
                <option value="1.6rem">ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹</option>
            </select>
            <button onclick="shareApp()" style="padding:15px; background:#f8f9fa; border:1px solid #eee; border-radius:12px; font-weight:bold;">ğŸ”— Ø£Ù†Ø´Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</button>
            <button onclick="closePages(event)" style="padding:15px; background:#333; color:white; border:none; border-radius:12px; font-weight:bold;">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>

    <div id="statsPage" class="page" style="background:#fff">
        <div class="page-top"><b>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ…</b></div>
        <div style="padding:40px; text-align:center;">
            <div style="font-size: 1.2rem; margin-bottom: 10px;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø°ÙƒØ§Ø± Ø§Ù„ÙŠÙˆÙ…</div>
            <h1 id="todayCount" style="font-size:5rem; color:#ff4500; margin:0;">0</h1>
            <button onclick="closePages(event)" style="padding:15px; width:100%; background:#eee; border:none; border-radius:12px; margin-top:30px; font-weight:bold;">Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        </div>
    </div>

    <script>
        // Ø¯Ø§Ù„Ø© ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙˆÙ‚Øª Ù„Ù†Ø¸Ø§Ù… 12 Ø³Ø§Ø¹Ø©
        function format12h(timeStr) {
            let [h, m] = timeStr.split(':');
            h = parseInt(h);
            let ampm = h >= 12 ? 'Ù…' : 'Øµ';
            h = h % 12 || 12;
            return `${h}:${m} ${ampm}`;
        }

        const morningList = [
            {t:"Ø¢ÙŠØ© Ø§Ù„ÙƒØ±Ø³ÙŠ", c:1}, {t:"Ø³ÙˆØ±Ø© Ø§Ù„Ø¥Ø®Ù„Ø§Øµ + Ø§Ù„ÙÙ„Ù‚ + Ø§Ù„Ù†Ø§Ø³ (3 Ù…Ø±Ø§Øª)", c:3},
            {t:"Ø£ØµØ¨Ø­Ù†Ø§ ÙˆØ£ØµØ¨Ø­ Ø§Ù„Ù…Ù„Ùƒ Ù„Ù„Ù‡ØŒ ÙˆØ§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ØŒ Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡ ÙˆØ­Ø¯Ù‡ Ù„Ø§ Ø´Ø±ÙŠÙƒ Ù„Ù‡...", c:1},
            {t:"Ø§Ù„Ù„Ù‡Ù… Ø¨Ùƒ Ø£ØµØ¨Ø­Ù†Ø§ØŒ ÙˆØ¨Ùƒ Ø£Ù…Ø³ÙŠÙ†Ø§ØŒ ÙˆØ¨Ùƒ Ù†Ø­ÙŠØ§ØŒ ÙˆØ¨Ùƒ Ù†Ù…ÙˆØªØŒ ÙˆØ¥Ù„ÙŠÙƒ Ø§Ù„Ù†Ø´ÙˆØ±", c:1},
            {t:"Ø³ÙŠØ¯ Ø§Ù„Ø§Ø³ØªØºÙØ§Ø±: Ø§Ù„Ù„Ù‡Ù… Ø£Ù†Øª Ø±Ø¨ÙŠ Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø£Ù†ØªØŒ Ø®Ù„Ù‚ØªÙ†ÙŠ ÙˆØ£Ù†Ø§ Ø¹Ø¨Ø¯Ùƒ...", c:1},
            {t:"Ø±Ø¶ÙŠØª Ø¨Ø§Ù„Ù„Ù‡ Ø±Ø¨Ù‹Ø§ ÙˆØ¨Ø§Ù„Ø¥Ø³Ù„Ø§Ù… Ø¯ÙŠÙ†Ù‹Ø§ ÙˆØ¨Ù…Ø­Ù…Ø¯ ï·º Ù†Ø¨ÙŠÙ‹Ø§", c:3},
            {t:"Ø­Ø³Ø¨ÙŠ Ø§Ù„Ù„Ù‡ Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ù‡Ùˆ Ø¹Ù„ÙŠÙ‡ ØªÙˆÙƒÙ„Øª ÙˆÙ‡Ùˆ Ø±Ø¨ Ø§Ù„Ø¹Ø±Ø´ Ø§Ù„Ø¹Ø¸ÙŠÙ…", c:7},
            {t:"Ø¨Ø³Ù… Ø§Ù„Ù„Ù‡ Ø§Ù„Ø°ÙŠ Ù„Ø§ ÙŠØ¶Ø± Ù…Ø¹ Ø§Ø³Ù…Ù‡ Ø´ÙŠØ¡ ÙÙŠ Ø§Ù„Ø£Ø±Ø¶ ÙˆÙ„Ø§ ÙÙŠ Ø§Ù„Ø³Ù…Ø§Ø¡", c:3},
            {t:"Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡ ÙˆØ¨Ø­Ù…Ø¯Ù‡", c:100},
            {t:"Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡ ÙˆØ­Ø¯Ù‡ Ù„Ø§ Ø´Ø±ÙŠÙƒ Ù„Ù‡ØŒ Ù„Ù‡ Ø§Ù„Ù…Ù„Ùƒ ÙˆÙ„Ù‡ Ø§Ù„Ø­Ù…Ø¯ ÙˆÙ‡Ùˆ Ø¹Ù„Ù‰ ÙƒÙ„ Ø´ÙŠØ¡ Ù‚Ø¯ÙŠØ±", c:100}
        ];
        const eveningList = morningList.map(i => ({ t: i.t.replace(/Ø£ØµØ¨Ø­/g, "Ø£Ù…Ø³Ù‰").replace(/Ø§Ù„Ù†Ø´ÙˆØ±/g, "Ø§Ù„Ù…ØµÙŠØ±"), c: i.c }));
        const sleepList = [
            {t:"Ø¢ÙŠØ© Ø§Ù„ÙƒØ±Ø³ÙŠ", c:1}, {t:"Ø§Ù„Ø¥Ø®Ù„Ø§Øµ + Ø§Ù„ÙÙ„Ù‚ + Ø§Ù„Ù†Ø§Ø³ (3 Ù…Ø±Ø§Øª)", c:3},
            {t:"Ø¨Ø§Ø³Ù…Ùƒ Ø±Ø¨ÙŠ ÙˆØ¶Ø¹Øª Ø¬Ù†Ø¨ÙŠ ÙˆØ¨Ùƒ Ø£Ø±ÙØ¹Ù‡...", c:1},
            {t:"Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡ (33)ØŒ Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ (33)ØŒ Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø± (34)", c:1},
            {t:"Ø¨Ø§Ø³Ù…Ùƒ Ø§Ù„Ù„Ù‡Ù… Ø£Ù…ÙˆØª ÙˆØ£Ø­ÙŠØ§", c:1}
        ];

        let customCounterList = JSON.parse(localStorage.getItem('customDhikr')) || [{t:"Ø£Ø³ØªØºÙØ± Ø§Ù„Ù„Ù‡", c:0}];
        const data = {
            morning: { title:"Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­", icon:"â˜€ï¸", grad:"var(--morn-grad)", list: morningList },
            evening: { title:"Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡", icon:"ğŸŒ‡", grad:"var(--even-grad)", list: eveningList },
            sleep: { title:"Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù†ÙˆÙ…", icon:"ğŸŒ™", grad:"var(--sleep-grad)", list: sleepList },
            counter: { title:"Ø§Ù„Ø¹Ø¯Ø§Ø¯", icon:"ğŸ“¿", grad:"var(--count-grad)", list: customCounterList, inf:true }
        };

        let active = '', idx = 0, count = 0;

        function start(type) {
            active = type; idx = 0; count = data[type].list[idx].c;
            document.getElementById('topIcon').innerText = data[type].icon;
            document.getElementById('topTitle').innerText = data[type].title;
            document.getElementById('pgContent').style.background = data[type].grad;
            document.getElementById('addBtn').style.display = type === 'counter' ? 'block' : 'none';
            document.getElementById('countLabel').innerText = data[type].inf ? "Ø§Ù„Ø¹Ø¯Ø¯" : "Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ";
            openPage('dhikrPage');
            updateUI();
        }

        function updateUI() {
            const item = data[active].list[idx];
            const txtEl = document.getElementById('txt');
            txtEl.innerText = item.t;
            document.getElementById('num').innerText = count;
            txtEl.classList.remove('fade'); void txtEl.offsetWidth; txtEl.classList.add('fade');
        }

        function handleTap() {
            if(data[active].inf) { 
                count++; 
            } else { 
                if(count > 0) count--;
                if(count === 0) {
                    if(idx < data[active].list.length - 1) { next(); return; }
                    else { alert("ØªÙ… Ø¨Ø­Ù…Ø¯ Ø§Ù„Ù„Ù‡ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ù† Ø§Ù„Ø£Ø°ÙƒØ§Ø±"); closePages(); return; }
                } 
            }
            let today = parseInt(localStorage.getItem('todayStats')) || 0;
            localStorage.setItem('todayStats', today + 1);
            document.getElementById('todayCount').innerText = today + 1;
            updateUI();
            if(navigator.vibrate) navigator.vibrate(35);
        }

        function resetProg(e) {
            e.stopPropagation();
            idx = 0;
            count = data[active].list[0].c;
            updateUI();
        }

        function addCustom(e) {
            e.stopPropagation();
            const text = prompt("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø°ÙƒØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯:");
            if (text) {
                data.counter.list.push({t: text, c: 0});
                localStorage.setItem('customDhikr', JSON.stringify(data.counter.list));
                idx = data.counter.list.length - 1; count = 0; updateUI();
            }
        }

        function next(e) { if(e) e.stopPropagation(); if(idx < data[active].list.length-1) { idx++; count=data[active].list[idx].c; updateUI(); } }
        function prev(e) { if(e) e.stopPropagation(); if(idx > 0) { idx--; count=data[active].list[idx].c; updateUI(); } }
        function openPage(id) { document.getElementById(id).classList.add('active'); }
        function closePages(e) { if(e) e.stopPropagation(); document.querySelectorAll('.page').forEach(p => p.classList.remove('active')); }
        function changeFontSize(s) { document.documentElement.style.setProperty('--font-size', s); }
        function shareApp() {
            const url = window.location.href;
            if(navigator.share) navigator.share({title:'ØªØ·Ø¨ÙŠÙ‚ Ø·Ù…Ø£Ù†ÙŠÙ†Ø©', url:url});
            else prompt("Ø§Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·:", url);
        }

        // Ø¬Ù„Ø¨ Ø§Ù„Ù…ÙˆØ§Ù‚ÙŠØª ÙˆØªÙ†Ø³ÙŠÙ‚Ù‡Ø§
        if(navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(pos => {
                fetch(`https://api.aladhan.com/v1/timings?latitude=${pos.coords.latitude}&longitude=${pos.coords.longitude}&method=4`)
                .then(r=>r.json()).then(res => {
                    const t = res.data.timings;
                    document.getElementById('fajr').innerText = format12h(t.Fajr);
                    document.getElementById('dhuhr').innerText = format12h(t.Dhuhr);
                    document.getElementById('asr').innerText = format12h(t.Asr);
                    document.getElementById('maghrib').innerText = format12h(t.Maghrib);
                    document.getElementById('isha').innerText = format12h(t.Isha);
                });
            });
        }
        document.getElementById('todayCount').innerText = localStorage.getItem('todayStats') || 0;
    </script>
</body>
</html>
